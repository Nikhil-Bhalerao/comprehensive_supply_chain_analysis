Clean Data and make it ready for analysis

installing packages and loading them

```{r}
install.packages("tidyverse")
library(tidyverse)
library(lubridate)
library(ggplot2)
```

import and load data set

```{r}
df <- read_csv("US_Regional_Sales_Data.csv")
df
```

check structure of data set and look for na or missing values in the data set

```{r}
spec(df)
na_values <-df %>%  map(~sum(is.na(.)))
na_values
```

now we have found that some columns in data set have incorrect data type and their are no missing values in data set and names of some columns are not in consistent format so we going to fix it

```{r}
#cleaning columns names and making it consistent for use

# Remove underscores from the start of each column name
us_rm_names <- gsub("^_+", "", colnames(df))

#replace whitespace with "_"
us_add_names <- gsub(" ", "_", us_rm_names)

# Add an underscore between the first uppercase letter and lowercase letter in each string
fixed_names <- sub("([a-z])([A-Z])", "\\1_\\2", us_add_names)
fixed_names
```

rename columns with the fixed names and other cleaning

```{r}
#split and convert fixed names to vector so we can set them as new names of the columns
new_names <- as.list(fixed_names)

colnames(df) <- new_names

#changing columns that have date values to date data type cause their current data type is character

fixed_dates <- df %>% select(Procured_Date, Order_Date, Ship_Date, Delivery_Date) %>% mutate_if(is.character, as.Date)

#if above line of code does not correct the format uncomment below line and run
#dmy(fixed_dates)

df <- df %>% mutate(Procured_Date = fixed_dates$Procured_Date, Order_Date = fixed_dates$Order_Date, Ship_Date = fixed_dates$Ship_Date, Delivery_Date = fixed_dates$Delivery_Date)

#remove $ sign from Unit_Cost and Unit_Price values
df$Unit_Cost <- gsub("\\$","", df$Unit_Cost)
df$Unit_Price <- gsub("\\$", "", df$Unit_Price)

#converting values to numeric data type

df$Unit_Cost <- gsub(",","", df$Unit_Cost)
df$Unit_Price <- gsub(",","", df$Unit_Price)

fixed_cost_price <- df %>% select(Unit_Cost, Unit_Price) %>% mutate_if(is.character, as.numeric)

df <- df %>%  mutate(Unit_Cost = fixed_cost_price$Unit_Cost, Unit_Price = fixed_cost_price$Unit_Price)
df

```

last check for structure to confirm that data is in correct format for analysis

```{r}
df %>%  map(~sum(is.na(.)))
glimpse(df)

#when write_csv method is used dates are converted back to character data type

#write this data to other file/export
write_csv(df, "US_Regional_Sales_Data_Cleaned.csv")
```






Now lets begin the analysis

```{r}
df_a <- read_csv("US_Regional_Sales_Data_Cleaned.csv")

#changing columns that contain dates to date data type

fixed_date <- df_a %>% select(Procured_Date, Order_Date, Ship_Date, Delivery_Date) %>% mutate_if(is.character, as.Date)

#if above line of code does not correct the format uncomment below line and run
#dmy(fixed_dates)

df_a <- df_a %>% mutate(Procured_Date = fixed_date$Procured_Date, Order_Date = fixed_date$Order_Date, Ship_Date = fixed_date$Ship_Date, Delivery_Date = fixed_date$Delivery_Date)

df_a$Sales <- (df_a$Order_Quantity*df_a$Unit_Price) - df_a$Discount_Applied

df_a$profit_per_sale <-   df_a$Sales - (df_a$Unit_Cost*df_a$Order_Quantity)

glimpse(df_a)

```

Most Sold & Profitable Products
```{r}
#most sold product
summary_ms_pro <- df_a %>%  group_by(Product_ID) %>% summarize(sum(Order_Quantity))
name_ms_pro <- list("Product_ID", "Quantity_Sold")
colnames(summary_ms_pro) <- name_ms_pro
summary_ms_pro

summary_ms_pro$Product_ID_fac <- factor(summary_ms_pro$Product_ID)

summary_ms_pro <- summary_ms_pro %>% arrange(desc(Quantity_Sold)) %>% head(10)
summary_ms_pro

ggplot(data = summary_ms_pro, aes(y=Product_ID_fac, x=Quantity_Sold)) + geom_col() + labs(x="Number Of Quantity Sold", y="Product ID's", title="Most Sold Products")
```

```{r}
#profitable product
summary_pro <- df_a %>% group_by(Product_ID) %>% summarize(sum(Sales))
name_pro <- list("Product_ID", "Sales")
colnames(summary_pro) <- name_pro
summary_pro

summary_pro$Product_ID_fac <- factor(summary_pro$Product_ID)

summary_pro <- summary_pro %>% arrange(desc(Sales)) %>% head(10)
summary_pro

ggplot(data = summary_pro, aes(y=Product_ID_fac, x=Sales)) + geom_col() + labs(y="Product ID's", x="Sales", title="Most Profitable Products")
```



channels used for sales
```{r}
ggplot(data = df_a, aes(x=Sales_Channel)) + geom_bar() + labs(x="Sales Channel", y="Number Of Times Channel Is Used For Sales", title = "Sales Channels Used For Selling Products")
```

sales generated by sales channels
```{r}
summary_c <- df_a %>%  group_by(Sales_Channel) %>% summarize(sum(Sales))
name_c_s <- list("Sales_Channel", "Sales")
colnames(summary_c) <- name_c_s

ggplot(data = summary_c, aes(x=Sales_Channel, y=Sales)) + geom_col() + labs(x="Sales Channel", title = "Sales Generated By Each Sales Channel")
```



warehouses used for sales and how much orders each warehouses have done/completed
```{r}
summary_w_o <- df_a %>% group_by(Warehouse_Code) %>% summarize(sum(Order_Quantity))

name_w <- list("Warehouse_Code", "Order_Quantity")
colnames(summary_w_o) <- name_w

summary_w_o

ggplot(data = summary_w_o, aes(y=Warehouse_Code,x=Order_Quantity)) + geom_col() + labs(y="Warehouses", x="Number Of Orders Completed")
```

top 10 stores by sales
```{r}
summary_s_s <- df_a %>% group_by(Store_ID) %>% summarize(sum(Sales))

name_s <- list("Store_ID", "Sales")
colnames(summary_s_s) <- name_s
summary_s_s

#getting top 10 stores
summary_s_s <- summary_s_s %>% arrange(desc(Sales)) %>% head(10)
summary_s_s

#creating factors cause when try to create viz its not working
summary_s_s$Store_ID_fac <- factor(summary_s_s$Store_ID)

ggplot(data = summary_s_s, aes(y=Store_ID_fac, x=Sales)) + geom_col() + labs(x="Sales", y="Store ID's", title = "Top 10 Store Sales")

```

top customers according to the amount of purchases

```{r}
summary_c_p <- df_a %>% group_by(Customer_ID) %>% summarize(sum(Sales))

name_c <- list("Customer_ID", "Total_Amount")
colnames(summary_c_p) <- name_c
summary_c_p

#getting top 10 customers
summary_c_p <- summary_c_p %>% arrange(desc(Total_Amount)) %>% head(10)
summary_c_p
```

```{r}
summary_c_p$Customer_ID_fac <- factor(summary_c_p$Customer_ID)

ggplot(data = summary_c_p, aes(y=Customer_ID_fac, x=Total_Amount)) + geom_col() + labs(x="Total Amount (USD)", y="Customer ID", title = "Top 10 customers")
```

Top 10 sales teams that has generated most sales
```{r}
summary_team <- df_a %>%  group_by(Sales_TeamID) %>% summarize(sum(Sales))

name_team <- list("Sales_Team_ID", "Sales")
colnames(summary_team) <- name_team
summary_team

summary_team$Sales_Team_ID_fac <- factor(summary_team$Sales_Team_ID)

#getting top 10 teams
summary_team <- summary_team %>% arrange(desc(Sales)) %>% head(10)
summary_team
```

```{r}
ggplot(data= summary_team, aes(y=Sales_Team_ID_fac, x=Sales)) + geom_col() + labs(y="Sales Teams", x="Sales Generated By Team", title = "Top 10 Sales Teams")
```








